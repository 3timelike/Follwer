{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nvar vue = require('vue');\nvar core = require('@vueuse/core');\nrequire('../../../hooks/index.js');\nrequire('../../form/index.js');\nrequire('../../../utils/index.js');\nrequire('../../../constants/index.js');\nvar segmented = require('./segmented.js');\nvar pluginVue_exportHelper = require('../../../_virtual/plugin-vue_export-helper.js');\nvar index = require('../../../hooks/use-namespace/index.js');\nvar index$1 = require('../../../hooks/use-id/index.js');\nvar useFormCommonProps = require('../../form/src/hooks/use-form-common-props.js');\nvar useFormItem = require('../../form/src/hooks/use-form-item.js');\nvar event = require('../../../constants/event.js');\nvar shared = require('@vue/shared');\nvar error = require('../../../utils/error.js');\nconst _hoisted_1 = [\"id\", \"aria-label\", \"aria-labelledby\"];\nconst _hoisted_2 = [\"name\", \"disabled\", \"checked\", \"onChange\"];\nconst __default__ = vue.defineComponent({\n  name: \"ElSegmented\"\n});\nconst _sfc_main = /* @__PURE__ */vue.defineComponent({\n  ...__default__,\n  props: segmented.segmentedProps,\n  emits: segmented.segmentedEmits,\n  setup(__props, {\n    emit\n  }) {\n    const props = __props;\n    const ns = index.useNamespace(\"segmented\");\n    const segmentedId = index$1.useId();\n    const segmentedSize = useFormCommonProps.useFormSize();\n    const _disabled = useFormCommonProps.useFormDisabled();\n    const {\n      formItem\n    } = useFormItem.useFormItem();\n    const {\n      inputId,\n      isLabeledByFormItem\n    } = useFormItem.useFormItemInputId(props, {\n      formItemContext: formItem\n    });\n    const segmentedRef = vue.ref(null);\n    const activeElement = core.useActiveElement();\n    const state = vue.reactive({\n      isInit: false,\n      width: 0,\n      translateX: 0,\n      disabled: false,\n      focusVisible: false\n    });\n    const handleChange = item => {\n      const value = getValue(item);\n      emit(event.UPDATE_MODEL_EVENT, value);\n      emit(event.CHANGE_EVENT, value);\n    };\n    const getValue = item => {\n      return shared.isObject(item) ? item.value : item;\n    };\n    const getLabel = item => {\n      return shared.isObject(item) ? item.label : item;\n    };\n    const getDisabled = item => {\n      return !!(_disabled.value || (shared.isObject(item) ? item.disabled : false));\n    };\n    const getSelected = item => {\n      return props.modelValue === getValue(item);\n    };\n    const getOption = value => {\n      return props.options.find(item => getValue(item) === value);\n    };\n    const getItemCls = item => {\n      return [ns.e(\"item\"), ns.is(\"selected\", getSelected(item)), ns.is(\"disabled\", getDisabled(item))];\n    };\n    const updateSelect = () => {\n      if (!segmentedRef.value) return;\n      const selectedItem = segmentedRef.value.querySelector(\".is-selected\");\n      const selectedItemInput = segmentedRef.value.querySelector(\".is-selected input\");\n      if (!selectedItem || !selectedItemInput) {\n        state.width = 0;\n        state.translateX = 0;\n        state.disabled = false;\n        state.focusVisible = false;\n        return;\n      }\n      const rect = selectedItem.getBoundingClientRect();\n      state.isInit = true;\n      state.width = rect.width;\n      state.translateX = selectedItem.offsetLeft;\n      state.disabled = getDisabled(getOption(props.modelValue));\n      try {\n        state.focusVisible = selectedItemInput.matches(\":focus-visible\");\n      } catch (e) {}\n    };\n    const segmentedCls = vue.computed(() => [ns.b(), ns.m(segmentedSize.value), ns.is(\"block\", props.block)]);\n    const selectedStyle = vue.computed(() => ({\n      width: `${state.width}px`,\n      transform: `translateX(${state.translateX}px)`,\n      display: state.isInit ? \"block\" : \"none\"\n    }));\n    const selectedCls = vue.computed(() => [ns.e(\"item-selected\"), ns.is(\"disabled\", state.disabled), ns.is(\"focus-visible\", state.focusVisible)]);\n    const name = vue.computed(() => {\n      return props.name || segmentedId.value;\n    });\n    core.useResizeObserver(segmentedRef, updateSelect);\n    vue.watch(activeElement, updateSelect);\n    vue.watch(() => props.modelValue, () => {\n      var _a;\n      updateSelect();\n      if (props.validateEvent) {\n        (_a = formItem == null ? void 0 : formItem.validate) == null ? void 0 : _a.call(formItem, \"change\").catch(err => error.debugWarn(err));\n      }\n    }, {\n      flush: \"post\"\n    });\n    return (_ctx, _cache) => {\n      return vue.openBlock(), vue.createElementBlock(\"div\", {\n        id: vue.unref(inputId),\n        ref_key: \"segmentedRef\",\n        ref: segmentedRef,\n        class: vue.normalizeClass(vue.unref(segmentedCls)),\n        role: \"radiogroup\",\n        \"aria-label\": !vue.unref(isLabeledByFormItem) ? _ctx.ariaLabel || \"segmented\" : void 0,\n        \"aria-labelledby\": vue.unref(isLabeledByFormItem) ? vue.unref(formItem).labelId : void 0\n      }, [vue.createElementVNode(\"div\", {\n        class: vue.normalizeClass(vue.unref(ns).e(\"group\"))\n      }, [vue.createElementVNode(\"div\", {\n        style: vue.normalizeStyle(vue.unref(selectedStyle)),\n        class: vue.normalizeClass(vue.unref(selectedCls))\n      }, null, 6), (vue.openBlock(true), vue.createElementBlock(vue.Fragment, null, vue.renderList(_ctx.options, (item, index) => {\n        return vue.openBlock(), vue.createElementBlock(\"label\", {\n          key: index,\n          class: vue.normalizeClass(getItemCls(item))\n        }, [vue.createElementVNode(\"input\", {\n          class: vue.normalizeClass(vue.unref(ns).e(\"item-input\")),\n          type: \"radio\",\n          name: vue.unref(name),\n          disabled: getDisabled(item),\n          checked: getSelected(item),\n          onChange: $event => handleChange(item)\n        }, null, 42, _hoisted_2), vue.createElementVNode(\"div\", {\n          class: vue.normalizeClass(vue.unref(ns).e(\"item-label\"))\n        }, [vue.renderSlot(_ctx.$slots, \"default\", {\n          item\n        }, () => [vue.createTextVNode(vue.toDisplayString(getLabel(item)), 1)])], 2)], 2);\n      }), 128))], 2)], 10, _hoisted_1);\n    };\n  }\n});\nvar Segmented = /* @__PURE__ */pluginVue_exportHelper[\"default\"](_sfc_main, [[\"__file\", \"segmented.vue\"]]);\nexports[\"default\"] = Segmented;","map":{"version":3,"names":["name","ns","index","useNamespace","segmentedId","index$1","useId","segmentedSize","useFormCommonProps","useFormSize","_disabled","useFormDisabled","formItem","useFormItem","inputId","isLabeledByFormItem","useFormItemInputId","props","formItemContext","segmentedRef","vue","ref","activeElement","core","useActiveElement","state","reactive","isInit","width","translateX","disabled","focusVisible","handleChange","item","value","getValue","emit","event","UPDATE_MODEL_EVENT","CHANGE_EVENT","shared","isObject","getLabel","label","getDisabled","getSelected","modelValue","getOption","options","find","getItemCls","e","is","updateSelect","selectedItem","querySelector","selectedItemInput","rect","getBoundingClientRect","offsetLeft","matches","segmentedCls","computed","b","m","block","selectedStyle","transform","display","selectedCls","useResizeObserver","watch","_a","validateEvent","validate","call","catch","err","error","debugWarn","flush"],"sources":["../../../../../../packages/components/segmented/src/segmented.vue"],"sourcesContent":["<template>\n  <div\n    :id=\"inputId\"\n    ref=\"segmentedRef\"\n    :class=\"segmentedCls\"\n    role=\"radiogroup\"\n    :aria-label=\"!isLabeledByFormItem ? ariaLabel || 'segmented' : undefined\"\n    :aria-labelledby=\"isLabeledByFormItem ? formItem!.labelId : undefined\"\n  >\n    <div :class=\"ns.e('group')\">\n      <div :style=\"selectedStyle\" :class=\"selectedCls\" />\n      <label\n        v-for=\"(item, index) in options\"\n        :key=\"index\"\n        :class=\"getItemCls(item)\"\n      >\n        <input\n          :class=\"ns.e('item-input')\"\n          type=\"radio\"\n          :name=\"name\"\n          :disabled=\"getDisabled(item)\"\n          :checked=\"getSelected(item)\"\n          @change=\"handleChange(item)\"\n        />\n        <div :class=\"ns.e('item-label')\">\n          <slot :item=\"item\">{{ getLabel(item) }}</slot>\n        </div>\n      </label>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { computed, reactive, ref, watch } from 'vue'\nimport { useActiveElement, useResizeObserver } from '@vueuse/core'\nimport { useId, useNamespace } from '@element-plus/hooks'\nimport {\n  useFormDisabled,\n  useFormItem,\n  useFormItemInputId,\n  useFormSize,\n} from '@element-plus/components/form'\nimport { debugWarn, isObject } from '@element-plus/utils'\nimport { CHANGE_EVENT, UPDATE_MODEL_EVENT } from '@element-plus/constants'\nimport { segmentedEmits, segmentedProps } from './segmented'\nimport type { Option } from './types'\n\ndefineOptions({\n  name: 'ElSegmented',\n})\n\nconst props = defineProps(segmentedProps)\nconst emit = defineEmits(segmentedEmits)\n\nconst ns = useNamespace('segmented')\nconst segmentedId = useId()\nconst segmentedSize = useFormSize()\nconst _disabled = useFormDisabled()\nconst { formItem } = useFormItem()\nconst { inputId, isLabeledByFormItem } = useFormItemInputId(props, {\n  formItemContext: formItem,\n})\n\nconst segmentedRef = ref<HTMLElement | null>(null)\nconst activeElement = useActiveElement()\n\nconst state = reactive({\n  isInit: false,\n  width: 0,\n  translateX: 0,\n  disabled: false,\n  focusVisible: false,\n})\n\nconst handleChange = (item: Option) => {\n  const value = getValue(item)\n  emit(UPDATE_MODEL_EVENT, value)\n  emit(CHANGE_EVENT, value)\n}\n\nconst getValue = (item: Option) => {\n  return isObject(item) ? item.value : item\n}\n\nconst getLabel = (item: Option) => {\n  return isObject(item) ? item.label : item\n}\n\nconst getDisabled = (item: Option) => {\n  return !!(_disabled.value || (isObject(item) ? item.disabled : false))\n}\n\nconst getSelected = (item: Option) => {\n  return props.modelValue === getValue(item)\n}\n\nconst getOption = (value: any) => {\n  return props.options.find((item) => getValue(item) === value)\n}\n\nconst getItemCls = (item: Option) => {\n  return [\n    ns.e('item'),\n    ns.is('selected', getSelected(item)),\n    ns.is('disabled', getDisabled(item)),\n  ]\n}\n\nconst updateSelect = () => {\n  if (!segmentedRef.value) return\n  const selectedItem = segmentedRef.value.querySelector(\n    '.is-selected'\n  ) as HTMLElement\n  const selectedItemInput = segmentedRef.value.querySelector(\n    '.is-selected input'\n  ) as HTMLElement\n  if (!selectedItem || !selectedItemInput) {\n    state.width = 0\n    state.translateX = 0\n    state.disabled = false\n    state.focusVisible = false\n    return\n  }\n  const rect = selectedItem.getBoundingClientRect()\n  state.isInit = true\n  state.width = rect.width\n  state.translateX = selectedItem.offsetLeft\n  state.disabled = getDisabled(getOption(props.modelValue))\n  try {\n    // This will failed in test\n    state.focusVisible = selectedItemInput.matches(':focus-visible')\n  } catch {}\n}\n\nconst segmentedCls = computed(() => [\n  ns.b(),\n  ns.m(segmentedSize.value),\n  ns.is('block', props.block),\n])\n\nconst selectedStyle = computed(() => ({\n  width: `${state.width}px`,\n  transform: `translateX(${state.translateX}px)`,\n  display: state.isInit ? 'block' : 'none',\n}))\n\nconst selectedCls = computed(() => [\n  ns.e('item-selected'),\n  ns.is('disabled', state.disabled),\n  ns.is('focus-visible', state.focusVisible),\n])\n\nconst name = computed(() => {\n  return props.name || segmentedId.value\n})\n\nuseResizeObserver(segmentedRef, updateSelect)\n\nwatch(activeElement, updateSelect)\n\nwatch(\n  () => props.modelValue,\n  () => {\n    updateSelect()\n    if (props.validateEvent) {\n      formItem?.validate?.('change').catch((err) => debugWarn(err))\n    }\n  },\n  {\n    flush: 'post',\n  }\n)\n</script>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}