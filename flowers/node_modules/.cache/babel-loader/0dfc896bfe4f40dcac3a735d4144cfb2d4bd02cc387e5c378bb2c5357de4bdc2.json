{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, '__esModule', {\n  value: true\n});\nvar vue = require('vue');\nrequire('../../../../hooks/index.js');\nvar constants = require('../constants.js');\nvar index = require('../../../../hooks/use-id/index.js');\nconst useFormItem = () => {\n  const form = vue.inject(constants.formContextKey, void 0);\n  const formItem = vue.inject(constants.formItemContextKey, void 0);\n  return {\n    form,\n    formItem\n  };\n};\nconst useFormItemInputId = (props, {\n  formItemContext,\n  disableIdGeneration,\n  disableIdManagement\n}) => {\n  if (!disableIdGeneration) {\n    disableIdGeneration = vue.ref(false);\n  }\n  if (!disableIdManagement) {\n    disableIdManagement = vue.ref(false);\n  }\n  const inputId = vue.ref();\n  let idUnwatch = void 0;\n  const isLabeledByFormItem = vue.computed(() => {\n    var _a;\n    return !!(!(props.label || props.ariaLabel) && formItemContext && formItemContext.inputIds && ((_a = formItemContext.inputIds) == null ? void 0 : _a.length) <= 1);\n  });\n  vue.onMounted(() => {\n    idUnwatch = vue.watch([vue.toRef(props, \"id\"), disableIdGeneration], ([id, disableIdGeneration2]) => {\n      const newId = id != null ? id : !disableIdGeneration2 ? index.useId().value : void 0;\n      if (newId !== inputId.value) {\n        if (formItemContext == null ? void 0 : formItemContext.removeInputId) {\n          inputId.value && formItemContext.removeInputId(inputId.value);\n          if (!(disableIdManagement == null ? void 0 : disableIdManagement.value) && !disableIdGeneration2 && newId) {\n            formItemContext.addInputId(newId);\n          }\n        }\n        inputId.value = newId;\n      }\n    }, {\n      immediate: true\n    });\n  });\n  vue.onUnmounted(() => {\n    idUnwatch && idUnwatch();\n    if (formItemContext == null ? void 0 : formItemContext.removeInputId) {\n      inputId.value && formItemContext.removeInputId(inputId.value);\n    }\n  });\n  return {\n    isLabeledByFormItem,\n    inputId\n  };\n};\nexports.useFormItem = useFormItem;\nexports.useFormItemInputId = useFormItemInputId;","map":{"version":3,"names":["useFormItem","form","vue","inject","constants","formContextKey","formItem","formItemContextKey","useFormItemInputId","props","formItemContext","disableIdGeneration","disableIdManagement","ref","inputId","idUnwatch","isLabeledByFormItem","computed","_a","label","ariaLabel","inputIds","length","onMounted","watch","toRef","id","disableIdGeneration2","newId","index","useId","value","removeInputId","addInputId","immediate","onUnmounted"],"sources":["../../../../../../../packages/components/form/src/hooks/use-form-item.ts"],"sourcesContent":["import {\n  computed,\n  inject,\n  onMounted,\n  onUnmounted,\n  ref,\n  toRef,\n  watch,\n} from 'vue'\nimport { useId } from '@element-plus/hooks'\nimport { formContextKey, formItemContextKey } from '../constants'\n\nimport type { ComputedRef, Ref, WatchStopHandle } from 'vue'\nimport type { FormItemContext } from '../types'\n\nexport const useFormItem = () => {\n  const form = inject(formContextKey, undefined)\n  const formItem = inject(formItemContextKey, undefined)\n  return {\n    form,\n    formItem,\n  }\n}\n\nexport type IUseFormItemInputCommonProps = {\n  id?: string\n  label?: string | number | boolean | Record<string, any>\n  ariaLabel?: string | number | boolean | Record<string, any>\n}\n\nexport const useFormItemInputId = (\n  props: Partial<IUseFormItemInputCommonProps>,\n  {\n    formItemContext,\n    disableIdGeneration,\n    disableIdManagement,\n  }: {\n    formItemContext?: FormItemContext\n    disableIdGeneration?: ComputedRef<boolean> | Ref<boolean>\n    disableIdManagement?: ComputedRef<boolean> | Ref<boolean>\n  }\n) => {\n  if (!disableIdGeneration) {\n    disableIdGeneration = ref<boolean>(false)\n  }\n  if (!disableIdManagement) {\n    disableIdManagement = ref<boolean>(false)\n  }\n\n  const inputId = ref<string>()\n  let idUnwatch: WatchStopHandle | undefined = undefined\n\n  const isLabeledByFormItem = computed<boolean>(() => {\n    return !!(\n      !(props.label || props.ariaLabel) &&\n      formItemContext &&\n      formItemContext.inputIds &&\n      formItemContext.inputIds?.length <= 1\n    )\n  })\n\n  // Generate id for ElFormItem label if not provided as prop\n  onMounted(() => {\n    idUnwatch = watch(\n      [toRef(props, 'id'), disableIdGeneration] as any,\n      ([id, disableIdGeneration]: [string, boolean]) => {\n        const newId = id ?? (!disableIdGeneration ? useId().value : undefined)\n        if (newId !== inputId.value) {\n          if (formItemContext?.removeInputId) {\n            inputId.value && formItemContext.removeInputId(inputId.value)\n            if (!disableIdManagement?.value && !disableIdGeneration && newId) {\n              formItemContext.addInputId(newId)\n            }\n          }\n          inputId.value = newId\n        }\n      },\n      { immediate: true }\n    )\n  })\n\n  onUnmounted(() => {\n    idUnwatch && idUnwatch()\n    if (formItemContext?.removeInputId) {\n      inputId.value && formItemContext.removeInputId(inputId.value)\n    }\n  })\n\n  return {\n    isLabeledByFormItem,\n    inputId,\n  }\n}\n"],"mappings":";;;;;;;;;AAWY,MAACA,WAAW,GAAGA,CAAA,KAAM;EAC/B,MAAMC,IAAI,GAAGC,GAAA,CAAAC,MAAM,CAACC,SAAA,CAAAC,cAAc,EAAE,KAAK,CAAC,CAAC;EAC3C,MAAMC,QAAQ,GAAGJ,GAAA,CAAAC,MAAM,CAACC,SAAA,CAAAG,kBAAkB,EAAE,KAAK,CAAC,CAAC;EACnD,OAAO;IACLN,IAAI;IACJK;EACJ,CAAG;AACH;AACY,MAACE,kBAAkB,GAAGA,CAACC,KAAK,EAAE;EACxCC,eAAe;EACfC,mBAAmB;EACnBC;AACF,CAAC,KAAK;EACJ,IAAI,CAACD,mBAAmB,EAAE;IACxBA,mBAAmB,GAAGT,GAAA,CAAAW,GAAG,CAAC,KAAK,CAAC;EACpC;EACE,IAAI,CAACD,mBAAmB,EAAE;IACxBA,mBAAmB,GAAGV,GAAA,CAAAW,GAAG,CAAC,KAAK,CAAC;EACpC;EACE,MAAMC,OAAO,GAAGZ,GAAA,CAAAW,GAAG,EAAE;EACrB,IAAIE,SAAS,GAAG,KAAK,CAAC;EACtB,MAAMC,mBAAmB,GAAGd,GAAA,CAAAe,QAAQ,CAAC,MAAM;IACzC,IAAIC,EAAE;IACN,OAAO,CAAC,EAAE,EAAET,KAAK,CAACU,KAAK,IAAIV,KAAK,CAACW,SAAS,CAAC,IAAIV,eAAe,IAAIA,eAAe,CAACW,QAAQ,IAAI,CAAC,CAACH,EAAE,GAAGR,eAAe,CAACW,QAAQ,KAAK,IAAI,GAAG,KAAK,CAAC,GAAGH,EAAE,CAACI,MAAM,KAAK,CAAC,CAAC;EACtK,CAAG,CAAC;EACFpB,GAAA,CAAAqB,SAAS,CAAC,MAAM;IACdR,SAAS,GAAGb,GAAA,CAAAsB,KAAK,CAAC,CAACtB,GAAA,CAAAuB,KAAK,CAAChB,KAAK,EAAE,IAAI,CAAC,EAAEE,mBAAmB,CAAC,EAAE,CAAC,CAACe,EAAE,EAAEC,oBAAoB,CAAC,KAAK;MAC3F,MAAMC,KAAK,GAAGF,EAAE,IAAI,IAAI,GAAGA,EAAE,GAAG,CAACC,oBAAoB,GAAGE,KAAA,CAAAC,KAAK,EAAE,CAACC,KAAK,GAAG,KAAK,CAAC;MAC9E,IAAIH,KAAK,KAAKd,OAAO,CAACiB,KAAK,EAAE;QAC3B,IAAIrB,eAAe,IAAI,IAAI,GAAG,KAAK,CAAC,GAAGA,eAAe,CAACsB,aAAa,EAAE;UACpElB,OAAO,CAACiB,KAAK,IAAIrB,eAAe,CAACsB,aAAa,CAAClB,OAAO,CAACiB,KAAK,CAAC;UAC7D,IAAI,EAAEnB,mBAAmB,IAAI,IAAI,GAAG,KAAK,CAAC,GAAGA,mBAAmB,CAACmB,KAAK,CAAC,IAAI,CAACJ,oBAAoB,IAAIC,KAAK,EAAE;YACzGlB,eAAe,CAACuB,UAAU,CAACL,KAAK,CAAC;UAC7C;QACA;QACQd,OAAO,CAACiB,KAAK,GAAGH,KAAK;MAC7B;IACA,CAAK,EAAE;MAAEM,SAAS,EAAE;IAAI,CAAE,CAAC;EAC3B,CAAG,CAAC;EACFhC,GAAA,CAAAiC,WAAW,CAAC,MAAM;IAChBpB,SAAS,IAAIA,SAAS,EAAE;IACxB,IAAIL,eAAe,IAAI,IAAI,GAAG,KAAK,CAAC,GAAGA,eAAe,CAACsB,aAAa,EAAE;MACpElB,OAAO,CAACiB,KAAK,IAAIrB,eAAe,CAACsB,aAAa,CAAClB,OAAO,CAACiB,KAAK,CAAC;IACnE;EACA,CAAG,CAAC;EACF,OAAO;IACLf,mBAAmB;IACnBF;EACJ,CAAG;AACH","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}